KM-5 OPC Server v0.2.6

Описание:
---------
OPC сервер для приборов КМ-5, формирующий все теги данных по расходу, температуре и тепловой энергии. 
Сервер также читает архивы с прибора и для накопительных величин дополнительно формирует интервальные архивы (часовые и суточные). 
Все значения заносятся в БД, раздельно в таблицы текущих, часовый и суточных значений.
В будущем будет добавлена возможность конфигурации выходной таблицы БД и работа с счетчиками воды серии РМ-5.
Сервер написан на базе свободно распространяемой библиотеки 
lightopc v0.88 (http://www.ipi.ac.ru/lab43/lopc-ru.html).

Описание файла настроек:
-----------------
Файл настроек km5.ini располагается в директории %SYSTEMROOT%\system32
[database] 	- раздел, описывающий подключение к БД
host=buf	- имя хоста, источника данных
login=root	- имя пользователя
pass=		- пароль

[Port1]		- описание сегмента устройств
COM=3		- номер порта, к которому подключен сегмент
Speed=9600	- скорость связи с прибором
Parity=NoParity	- четность
Databits=8	- количество бит данных

[com3]		- раздел описания сегмента
01=5464066	- идентификатор устройства
	- дальше можно добавлять сколько угодно устройств

Установка и настройка:
-------------------
Инсталлятора к этому простейшему серверу не прилагается. Подразумевается, что пользователь имеет
представление о работе компонентов системы и сможет осуществить нижеперечисленные операции (если, конечно, он обладает правами администратора).
После настройки, конфигурационный файл необходимо скопировать в директорию %SYSTEMROOT%/System32
Остальное содержимое архиво можно разархивировать в произвольную директорию.
После распаковки сервер необходимо зарегистрировать, запустив его с ключом /r.
Если сервер вам больше не нужен, то вы можете его разрегистрировать с ключом /u.
Например 
opc10.exe /r  - регистрировать сервер
opc10.exe /u  - удалить регистрацию сервера 
opc10.exe /?  - вывод справки 

история:
--------
v0.2 build 7
= исправлена неточность вычисления интервальных архивов, когда значение записывалось на сутки раньше
= исправлена ошибка, дублированных записей в таблицу данных
+ добавлен фрагмент реконнекта к базе в случае накопления 10 и более ошибок в запросах

v0.1 build 1
релиз

